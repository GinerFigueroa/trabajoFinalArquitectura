-- EJECUTAR ESTO EN TU BASE DE DATOS
CREATE TABLE `password_reset_tokens` (
  `id_token` int(11) NOT NULL AUTO_INCREMENT,
  `id_usuario` int(11) NOT NULL,
  `token` varchar(255) NOT NULL,
  `fecha_creacion` timestamp NOT NULL DEFAULT current_timestamp(),
  `fecha_expiracion` timestamp NOT NULL,
  `utilizado` tinyint(1) DEFAULT 0,
  `ip_solicitud` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`id_token`),
  UNIQUE KEY `token` (`token`),
  KEY `id_usuario` (`id_usuario`),
  KEY `idx_token_expiracion` (`token`,`fecha_expiracion`,`utilizado`),
  CONSTRAINT `password_reset_tokens_ibfk_1` 
    FOREIGN KEY (`id_usuario`) REFERENCES `usuarios` (`id_usuario`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish2_ci;


<?php
// recuperacionPassword/resetPassword/indexResetPassword.php

include_once("./formResetPassword.php");

// Validar que se haya proporcionado token
if (!isset($_GET['token']) || empty($_GET['token'])) {
    header("Location: ../indexRecuperacionPassword.php");
    exit();
}

$token = $_GET['token'];
$objForm = new formResetPassword();
$objForm->formResetPasswordShow($token);
?>